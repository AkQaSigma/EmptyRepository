-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 24 OF THE SOURCE CODE. **
--/**********
--<company="Mobilize.Net">
--    Copyright (C) Mobilize.Net info@mobilize.net - All Rights Reserved
--    This file is part of the Mobilize Frameworks, which is
--    proprietary and confidential.
--    NOTICE:  All information contained herein is, and remains
--    the property of Mobilize.Net Corporation.
--    The intellectual and technical concepts contained herein are
--    proprietary to Mobilize.Net Corporation and may be covered
--    by U.S. Patents, and are protected by trade secret or copyright law.
--    Dissemination of this information or reproduction of this material
--    is strictly forbidden unless prior written permission is obtained
--    from Mobilize.Net Corporation.
--</copyright>
--**********/

--/***********************************************/
--/************** PROCEDURES *********************/
--/***********************************************/


--/************** MULTIPLE RESULT SETS *********************/
-------------
--REPLACE PROCEDURE ORG_DEV.DYNAMIC_RESULT_SETS()
--	DYNAMIC RESULT SETS 2
--	BEGIN

-- 		DECLARE SQL_CMD,SQL_CMD_1  VARCHAR(20000) DEFAULT ' '

-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 30 OF THE SOURCE CODE. **
-- 		DECLARE RESULTSET CURSOR WITH RETURN ONLY FOR FIRSTSTATEMENT
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 31 OF THE SOURCE CODE. **
-- 		DECLARE RESULTSET1 CURSOR WITH RETURN ONLY FOR FIRSTSTATEMENT1

-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 34 OF THE SOURCE CODE. **
-- 		-------- MAIN --------
-- 		SET SQL_CMD='SEL * FROM HR.EMPLOYEE'
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 35 OF THE SOURCE CODE. **
--		SET SQL_CMD_1='SEL * FROM HR.EMPLOYEE_PHONE_INFO'

		-------- CURSORS --------
		PREPARE FIRSTSTATEMENT FROM SQL_CMD;

		OPEN RESULTSET;

		PREPARE FIRSTSTATEMENT1 FROM SQL_CMD_1;

		OPEN RESULTSET1;
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 43 OF THE SOURCE CODE. **
--	END

-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 48 OF THE SOURCE CODE. **
--/************** FOR CURSOR FOR STATEMENTS *********************/
-------------
--REPLACE PROCEDURE ORG_DEV.FOR_STATEMENT()
--BEGIN
--FOR fUsgClass AS cUsgClass CURSOR FOR
--    SELECT COL0,
--    TRIM(COL1) AS COL1ALIAS,
--    TRIM(COL2),
--    COL3
--    FROM ORG_DEV.Some_Other_Table
--DO
--    SET lvSeqNo = lvSeqNo + 1
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 58 OF THE SOURCE CODE. **
--	SET hola = fUsgClass.COL1ALIAS + 1
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 59 OF THE SOURCE CODE. **
--    SET HOLA2 = fUsgClass.COL3 + 123
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 60 OF THE SOURCE CODE. **
--END FOR
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 61 OF THE SOURCE CODE. **
--END

-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 66 OF THE SOURCE CODE. **
--/************** DYNAMIC SQL, ACTIVITY_COUNT, CURSOR FOR, IF/THEN, Variable *********************/
-------------
--REPLACE PROCEDURE "SNOWCONVERT"."CURSORS"
--(
--  IN "v_TargetTable" VARCHAR(300) CHARACTER SET LATIN
--  )
--DYNAMIC RESULT SETS 1

--BEGIN

--	DECLARE v_emp_id VARCHAR(50)
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 75 OF THE SOURCE CODE. **
--    DECLARE v_emp_name VARCHAR(50)
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 76 OF THE SOURCE CODE. **
--    DECLARE v_MySQLCode INTEGER
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 77 OF THE SOURCE CODE. **
--	DECLARE v_MySQLState CHAR(5)
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 78 OF THE SOURCE CODE. **
--	DECLARE v_CNT, v_KEEPCOUNT INTEGER
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 79 OF THE SOURCE CODE. **
--	DECLARE v_ACT_CNT INTEGER

	DECLARE CUR1 CURSOR FOR SELECT 'EMPLOYEE' as id_el, EMP_NAME as id_la FROM
			HR.EMPLOYEE;

	CALL DBC.SYSEXECSQL('DELETE ORG_DEV.ACT_COUNT ALL;');

-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 84 OF THE SOURCE CODE. **
--	SET v_ACT_CNT = ACTIVITY_COUNT

	CALL DBC.SYSEXECSQL('INSERT INTO ORG_DEV.ACT_COUNT(' || NVL(v_ACT_CNT :: STRING, '') || ',''FIRST'');');

	CALL DBC.SYSEXECSQL('DROP TABLE HR.EMPLOYEE_DUPE');

	CALL DBC.SYSEXECSQL('CREATE MULTISET TABLE HR.EMPLOYEE_DUPE AS (SELECT * FROM HR.EMPLOYEE) WITH DATA');

	CALL DBC.SYSEXECSQL('UPDATE HR.EMPLOYEE_DUPE SET EMP_NAME = ''BOB'' WHERE EMP_ID <=2');

-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 92 OF THE SOURCE CODE. **
--	SET v_ACT_CNT = v_ACT_CNT + ACTIVITY_COUNT

	CALL DBC.SYSEXECSQL('INSERT INTO ORG_DEV.ACT_COUNT(' || NVL(v_ACT_CNT :: STRING, '') || ',''SECOND'');');

	CALL DBC.SYSEXECSQL('DELETE FROM HR.EMPLOYEE_DUPE WHERE EMP_ID = 4');

-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 97 OF THE SOURCE CODE. **
--	SET v_ACT_CNT = v_ACT_CNT + ACTIVITY_COUNT

	CALL DBC.SYSEXECSQL('INSERT INTO ORG_DEV.ACT_COUNT(' || NVL(v_ACT_CNT :: STRING, '') || ',''THIRD'');');

	OPEN CUR1;

-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 102 OF THE SOURCE CODE. **
--	SET v_KEEPCOUNT = v_ACT_CNT - 1
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 103 OF THE SOURCE CODE. **
--	SET v_CNT = 1

-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 105 OF THE SOURCE CODE. **
--	WHILE (v_CNT < v_KEEPCOUNT) DO
--		FETCH CUR1 INTO v_emp_id, v_emp_name

	CALL DBC.SYSEXECSQL('ALTER TABLE ' || NVL(v_TargetTable :: STRING, '') || ' ADD AT_' || NVL(v_emp_name :: STRING, '') || ' VARCHAR(85) CHARACTER SET LATIN CASESPECIFIC;');

	CALL DBC.SYSEXECSQL('UPDATE ' || NVL(v_TargetTable :: STRING, '') || ' SET AT_' || NVL(v_emp_name :: STRING, '') || ' = (SELECT EMP_NAME FROM HR.EMPLOYEE WHERE EMP_ID = ' || NVL(v_CNT :: STRING, '') || ');');
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 109 OF THE SOURCE CODE. **
--		SET v_CNT = v_CNT + 1
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 110 OF THE SOURCE CODE. **
--	END WHILE
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 111 OF THE SOURCE CODE. **
--END

	CALL ORG_DEV.CURSORS('EMPLOYEE_DUPE');

SELECT * FROM
		HR.EMPLOYEE_DUPE;

-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 120 OF THE SOURCE CODE. **
--/************** WHILE LOOP, DYNAMIC SQL, SYSTEM TABLE QUERIES, UPDATE RESTRUCTURE, IF/THEN *********************/
-------------
--REPLACE PROCEDURE ORG_DEV.CREATE_INSERTS
-- (
-- IN DB_NAME varchar(500), IN TBL_NAME VARCHAR(500)
---- ,OUT SSQQLL VARCHAR(10000)
-- )
--	DYNAMIC RESULT SETS 1
--	BEGIN

--		DECLARE COL_NAME, SUFFIX, PREFIX, MIDDLE, PRE_STMT, COL_TYPE, PREV_COL_TYPE VARCHAR(200)
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 129 OF THE SOURCE CODE. **
--		DECLARE COL_LIST, SQL_STMT CLOB(200000)
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 130 OF THE SOURCE CODE. **
--		DECLARE SQL_CMD VARCHAR(32000)
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 131 OF THE SOURCE CODE. **
--		DECLARE COL_COUNT, NUM_COLS, COL_LEN, BIG_OBJ INTEGER
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 132 OF THE SOURCE CODE. **
-- 		DECLARE RESULTSET CURSOR WITH RETURN ONLY FOR FIRSTSTATEMENT

		DECLARE CUR2 CURSOR FOR SELECT COUNT(COLUMNNAME) FROM
			DBC.COLUMNS
		WHERE DATABASENAME = DB_NAME AND TABLENAME = TBL_NAME GROUP BY DATABASENAME, TABLENAME ORDER BY TABLENAME;

		DECLARE CUR3 CURSOR FOR SELECT TRIM(UPPER(COLUMNNAME)) FROM
			DBC.COLUMNS
		WHERE DATABASENAME = DB_NAME AND TABLENAME = TBL_NAME ORDER BY DATABASENAME, TABLENAME, COLUMNNAME;

		DECLARE CUR4 CURSOR FOR SELECT CASE WHEN COLUMNTYPE IN ('I', 'DA') THEN 20 ELSE COLUMNLENGTH END FROM
			DBC.COLUMNS
		WHERE DATABASENAME = DB_NAME AND TABLENAME = TBL_NAME ORDER BY DATABASENAME, TABLENAME, COLUMNNAME;

		DECLARE CUR5 CURSOR FOR SELECT COLUMNTYPE FROM
			DBC.COLUMNS
		WHERE DATABASENAME = DB_NAME AND TABLENAME = TBL_NAME ORDER BY DATABASENAME, TABLENAME, COLUMNNAME;

		CALL DBC.SYSEXECSQL('UPDATE MOD_TBL FROM PRODUCT.DIMACCOUNT MOD_TBL SET ACCOUNTTYPE = ''Revenue'' WHERE MOD_TBL.ACCOUNTKEY = 61;');

		CALL DBC.SYSEXECSQL('UPDATE MOD_TBL FROM PRODUCT.DIMACCOUNT MOD_TBL SET ACCOUNTTYPE = ''Expenditures'' WHERE MOD_TBL.ACCOUNTKEY = 61;');

		OPEN CUR2;

		OPEN CUR3;

		OPEN CUR4;

		OPEN CUR5;

		FETCH CUR2 INTO NUM_COLS;

		FETCH CUR3 INTO COL_NAME;

		FETCH CUR4 INTO COL_LEN;

		FETCH CUR5 INTO COL_TYPE;
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 158 OF THE SOURCE CODE. **
--		SET COL_COUNT = 2
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 159 OF THE SOURCE CODE. **
--		SET COL_LIST = ''
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 160 OF THE SOURCE CODE. **
--		SET SQL_STMT = ''
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 161 OF THE SOURCE CODE. **
--		SET BIG_OBJ = 1

-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 163 OF THE SOURCE CODE. **
--		WHILE (BIG_OBJ <> 0) DO
--			IF (COL_TYPE = 'BO') THEN
--				SET COL_COUNT = COL_COUNT + 1

				FETCH CUR3 INTO COL_NAME;

				FETCH CUR4 INTO COL_LEN;
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 168 OF THE SOURCE CODE. **
--				SET PREV_COL_TYPE = COL_TYPE

				FETCH CUR5 INTO COL_TYPE;
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 170 OF THE SOURCE CODE. **
--			ELSE
--				SET BIG_OBJ = 0
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 172 OF THE SOURCE CODE. **
--			END IF
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 173 OF THE SOURCE CODE. **
--		END WHILE

-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 175 OF THE SOURCE CODE. **
--		IF (COL_NAME IN ('CLASS', 'DATE', 'CLASS')) THEN
--			SET COL_NAME = '"' || COL_NAME || '"'
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 177 OF THE SOURCE CODE. **
--		END IF

-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 179 OF THE SOURCE CODE. **
--		SET PREFIX = 'SELECT ''INSERT INTO ' || DB_NAME || '.' || TBL_NAME || '(' || COL_NAME


-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 182 OF THE SOURCE CODE. **
--		SET PRE_STMT = 'CAST(OREPLACE(TRIM(COALESCE(CAST("' || COL_NAME || '" AS VARCHAR(' || COL_LEN ||')), ' || '''''' || ')), '''''''', '''''''''''') AS VARCHAR(' || COL_LEN+5 || '))'

-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 184 OF THE SOURCE CODE. **
--		WHILE (COL_COUNT <= NUM_COLS) DO
--			FETCH CUR3 INTO COL_NAME
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 186 OF THE SOURCE CODE. **
--			IF (COL_NAME IN ('CLASS', 'DATE', 'CLASS')) THEN
--				SET COL_NAME = '"' || COL_NAME || '"'
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 188 OF THE SOURCE CODE. **
--			END IF

			FETCH CUR4 INTO COL_LEN;
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 190 OF THE SOURCE CODE. **
--			SET PREV_COL_TYPE = COL_TYPE

			FETCH CUR5 INTO COL_TYPE;
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 192 OF THE SOURCE CODE. **
--			IF (COL_TYPE <> 'BO') THEN
--				SET COL_LIST = COL_LIST || ', ' || COL_NAME
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 194 OF THE SOURCE CODE. **
--				IF (PREV_COL_TYPE = 'PD') THEN
--					SET SQL_STMT = SQL_STMT || ' || '', '
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 196 OF THE SOURCE CODE. **
--				ELSE
--					SET SQL_STMT = SQL_STMT || ' || '''''', '
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 198 OF THE SOURCE CODE. **
--				END IF
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 199 OF THE SOURCE CODE. **
--				IF (COL_TYPE = 'PD') THEN
--					SET SQL_STMT = SQL_STMT || 'PERIOD (DATE'''''' || CAST(BEGIN(' || COL_NAME || ') AS VARCHAR(10)) || '''''', DATE '''''' || CAST(END(' || COL_NAME || ')AS VARCHAR(10)) || '''''')'''
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 201 OF THE SOURCE CODE. **
--				ELSE
--					SET SQL_STMT = SQL_STMT || ''''''' || CAST(OREPLACE(TRIM(COALESCE(CAST("' || COL_NAME || '" AS VARCHAR(' || COL_LEN ||')), ' || '''''' || ')), '''''''', '''''''''''') AS VARCHAR(' || COL_LEN+5 || '))'
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 203 OF THE SOURCE CODE. **
--				END IF
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 204 OF THE SOURCE CODE. **
--			END IF
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 205 OF THE SOURCE CODE. **
--			SET COL_COUNT = COL_COUNT + 1
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 206 OF THE SOURCE CODE. **
--		END WHILE

-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 208 OF THE SOURCE CODE. **
--		SET SUFFIX = ' || '''''');'' "--"  FROM ' || DB_NAME || '.' || TBL_NAME || ';'
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 209 OF THE SOURCE CODE. **
--		SET MIDDLE = ') VALUES('''''' || '
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 210 OF THE SOURCE CODE. **
--		SET SQL_CMD = PREFIX || COL_LIST || MIDDLE || PRE_STMT || SQL_STMT || SUFFIX

--		SET SSQQLL = SQL_CMD;	
		PREPARE FIRSTSTATEMENT FROM SQL_CMD;

		OPEN RESULTSET;
-- ** MSC-ERROR - MSCEWI1001 - UNRECOGNIZED TOKEN ON LINE 215 OF THE SOURCE CODE. **
--	END